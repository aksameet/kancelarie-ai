<!-- src/app/features/ai-chat/ai-chat.component.html -->
<div class="flex-1 overflow-y-auto space-y-4 pr-2">
  <!-- pojedyncza wiadomość -->
  <ng-container *ngFor="let m of messages">
    <!-- USER -->
    <div *ngIf="m.role === 'user'" class="self-end bg-indigo-50 p-3 rounded-lg">
      {{ m.content }}
    </div>

    <!-- AI -->
    <div *ngIf="m.role === 'ai'" class="bg-gray-100 p-3 rounded-lg">
      <!-- spinner, gdy content = __loading__ -->
      <ng-container *ngIf="m.content === '__loading__'; else realAnswer">
        <svg class="animate-spin h-5 w-5 text-gray-500" viewBox="0 0 24 24">
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
            fill="none"
          />
          <path
            class="opacity-75"
            d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
            fill="currentColor"
          />
        </svg>
      </ng-container>

      <!-- gotowa odpowiedź -->
      <ng-template #realAnswer>
        <p>{{ m.content }}</p>

        <!-- opcjonalnie zwinięte myśli -->
        <details *ngIf="m.thoughts">
          <summary class="text-xs text-gray-500 cursor-pointer">
            Pokaż myśli modelu
          </summary>
          <pre class="whitespace-pre-wrap text-xs mt-1">{{ m.thoughts }}</pre>
        </details>
      </ng-template>
    </div>
  </ng-container>
</div>

<!-- textarea + przycisk -->
<form class="mt-4 flex gap-2" (ngSubmit)="send()">
  <input
    [(ngModel)]="draft"
    name="draft"
    required
    placeholder="Zadaj pytanie…"
    class="flex-1 border rounded-lg px-3 py-2"
  />
  <button
    type="submit"
    [disabled]="loading || !draft.trim()"
    class="px-4 py-2 bg-indigo-600 text-white rounded-lg"
  >
    Wyślij
  </button>
</form>
